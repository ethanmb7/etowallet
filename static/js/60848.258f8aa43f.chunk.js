"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[60848],{660848:(e,r,t)=>{t.r(r),t.d(r,{default:()=>b});var o=t(324586),s=t(586330),a=t(514041),n=t(654266),i=t(908867),l=t(490343),d=t(610421),u=t(498356),c=t(796895),m=t(24284),_=t(334439),f=t(491180),p=t(796151),g=t(831085);function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){(0,o.A)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}const b=function AddCustomNetwork(){var e,r,t,o,b,k,w,v,y=(0,i.A)(),h=(0,u.A)(),x=(0,n.lq)(),{state:E,networkId:T,onSuccess:j,onDeleteSuccess:M,networkName:C,rpcUrl:I,chainId:A,symbol:O,blockExplorerUrl:U}=null!=(e=x.params)?e:{},{$sourceInfo:N,networkInfo:P}=(0,m.A)(),F=(0,c.A)({id:null!=(r=N?.id)?r:"",closeWindowAfterResolved:!0}),S=(0,l.useForm)({mode:"onBlur",defaultValues:{networkName:null!=(t=null!=C?C:P?.chainName)?t:"",rpcUrl:null!=(o=null!=I?I:P?.rpcUrls?.[0])?o:"",chainId:null!=A?A:P?.chainId?Number(P?.chainId):void 0,symbol:null!=(b=null!=O?O:P?.nativeCurrency?.symbol)?b:"",blockExplorerUrl:null!=(k=null!=U?U:P?.blockExplorerUrls?.[0])?k:""}}),[q,z]=(0,a.useState)(!1),$=(0,a.useCallback)((w=(0,s.A)((function*(e){try{z(!0);var{chainId:r}=yield d.A.serviceCustomRpc.getChainIdByRpcUrl({rpcUrl:e});return r&&S.setValue("chainId",r),r}finally{z(!1)}})),function(e){return w.apply(this,arguments)}),[S]),[D,R]=(0,a.useState)(!1),B=(0,a.useCallback)((0,s.A)((function*(){try{if(R(!0),!(yield S.trigger()))return;var{networkName:e,rpcUrl:r,chainId:t,symbol:o,blockExplorerUrl:s}=S.getValues(),a=t;try{if(!a){var n=yield $(r);n&&(a=n)}if(!a)return void l.Toast.error({title:y.formatMessage({id:_.ETranslations.form_rpc_url_invalid})})}catch(e){return void l.Toast.error({title:y.formatMessage({id:_.ETranslations.form_rpc_url_invalid})})}var i=f.A.buildCustomEvmNetworkId({chainId:a.toString()}),u=yield d.A.serviceNetwork.getNetworkSafe({networkId:i});if(u&&!u.isCustomNetwork)return void l.Toast.error({title:y.formatMessage({id:_.ETranslations.custom_network_network_exists_feedback_text})});var c={networkName:e,rpcUrl:r,chainId:a,symbol:o,blockExplorerUrl:s};yield d.A.serviceCustomRpc.upsertCustomNetwork(c);var m=yield d.A.serviceNetwork.getNetwork({networkId:i});F.resolve({result:m}),setTimeout((function(){j?.(m)}),500),l.Toast.success({title:y.formatMessage({id:_.ETranslations.custom_network_add_custom_network_successfully_toast_text})}),h.pop()}catch(e){l.Toast.error({title:y.formatMessage({id:_.ETranslations.custom_network_add_custom_network_failed_toast_text})})}finally{R(!1)}})),[S,F,y,h,$,j]),K=(0,a.useCallback)((0,s.A)((function*(){var e;T&&l.Dialog.show({title:y.formatMessage({id:_.ETranslations.custom_network_remove_network_dialog_title}),description:y.formatMessage({id:_.ETranslations.custom_network_remove_network_dialog_description}),showCancelButton:!0,onConfirmText:y.formatMessage({id:_.ETranslations.global_remove}),confirmButtonProps:{variant:"destructive"},onConfirm:(e=(0,s.A)((function*({close:e}){yield d.A.serviceCustomRpc.deleteCustomNetwork({networkId:T}),l.Toast.success({title:y.formatMessage({id:_.ETranslations.explore_removed_success})}),h.pop(),M?.(),yield e()})),function onConfirm(r){return e.apply(this,arguments)})})})),[T,y,h,M]),V=(0,a.useCallback)((function(){return"edit"!==E?null:(0,g.jsx)(l.IconButton,{title:y.formatMessage({id:_.ETranslations.global_remove}),icon:"DeleteOutline",variant:"tertiary",iconColor:"$iconSubdued",onPress:function(){return K()}})}),[E,y,K]);return(0,g.jsxs)(l.Page,{scrollEnabled:!0,children:[(0,g.jsx)(l.Page.Header,{title:y.formatMessage({id:_.ETranslations.custom_network_add_network_action_text}),headerRight:V}),(0,g.jsxs)(l.Page.Body,{px:"$5",gap:"$5",children:[(0,g.jsx)(l.Alert,{icon:"ErrorOutline",type:"warning",title:y.formatMessage({id:_.ETranslations.custom_network_form_alert_text})}),(0,g.jsxs)(l.Form,{form:S,children:[(0,g.jsx)(l.Form.Field,{name:"networkName",label:y.formatMessage({id:_.ETranslations.form_network_name_label}),rules:{required:{value:!0,message:y.formatMessage({id:_.ETranslations.address_book_add_address_name_required})}},children:(0,g.jsx)(l.Input,{size:"large",$gtMd:{size:"medium"}})}),(0,g.jsx)(l.Form.Field,{name:"rpcUrl",label:"RPC URL",rules:{required:{value:!0,message:y.formatMessage({id:_.ETranslations.address_book_add_address_name_required})},validate:(v=(0,s.A)((function*(e){if(e)return p.Ay.parseUrl(e)?e.startsWith("http")?void(yield $(e)):y.formatMessage({id:_.ETranslations.form_rpc_url_prefix_required}):y.formatMessage({id:_.ETranslations.form_rpc_url_invalid})})),function validate(e){return v.apply(this,arguments)})},children:(0,g.jsx)(l.Input,_objectSpread({size:"large",$gtMd:{size:"medium"}},q&&{addOns:[{loading:!0}]}))}),(0,g.jsx)(l.Form.Field,{name:"chainId",label:"Chain ID",rules:{required:{value:!0,message:y.formatMessage({id:_.ETranslations.address_book_add_address_name_required})}},disabled:!0,children:(0,g.jsx)(l.Input,{size:"large",$gtMd:{size:"medium"},editable:!1})}),(0,g.jsx)(l.Form.Field,{name:"symbol",label:y.formatMessage({id:_.ETranslations.manage_token_custom_token_symbol}),rules:{required:{value:!0,message:y.formatMessage({id:_.ETranslations.address_book_add_address_name_required})}},children:(0,g.jsx)(l.Input,{size:"large",$gtMd:{size:"medium"}})}),(0,g.jsx)(l.Form.Field,{name:"blockExplorerUrl",label:y.formatMessage({id:_.ETranslations.form_block_explorer_url_label}),optional:!0,rules:{validate:function(e){if(e)return p.Ay.parseUrl(e)?e.startsWith("http")?void 0:y.formatMessage({id:_.ETranslations.form_rpc_url_prefix_required}):y.formatMessage({id:_.ETranslations.form_rpc_url_invalid})}},children:(0,g.jsx)(l.Input,{size:"large",$gtMd:{size:"medium"}})})]})]}),(0,g.jsx)(l.Page.Footer,{onConfirmText:y.formatMessage({id:_.ETranslations.action_save}),onCancelText:y.formatMessage({id:_.ETranslations.global_cancel}),confirmButtonProps:{loading:D},onConfirm:function(){return S.handleSubmit(B)()},onCancel:function(){return F.reject()}})]})}}}]);