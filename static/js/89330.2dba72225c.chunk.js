"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[89330],{304695:(e,t,r)=>{r.d(t,{V:()=>NetworksFilterItem});var n=r(324586),o=r(839850),c=r(17617),i=r(490343),a=r(831085),s=["networkImageUri","networkName","isSelected","tooltipContent","disabled"];function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function NetworksFilterItem(e){var{networkImageUri:t,networkName:r,isSelected:n,tooltipContent:u,disabled:d}=e,l=(0,o.A)(e,s),f=(0,a.jsxs)(i.XStack,_objectSpread(_objectSpread(_objectSpread(_objectSpread({justifyContent:"center",px:"$3",py:"$1.5",borderRadius:"$2",userSelect:"none",borderWidth:c.A.hairlineWidth,borderColor:n?"$borderActive":"$border"},!n&&!d&&{focusable:!0,hoverStyle:{bg:"$bgStrongHover"},pressStyle:{bg:"$bgStrongActive"},focusVisibleStyle:{outlineWidth:2,outlineStyle:"solid",outlineColor:"$focusRing"}}),d&&{opacity:.5}),l),{},{children:[t?(0,a.jsx)(i.Image,{height:"$6",width:"$6",borderRadius:"$full",$gtMd:{height:"$5",width:"$5"},children:(0,a.jsx)(i.Image.Source,{source:{uri:t}})}):null,r?(0,a.jsx)(i.SizableText,{numberOfLines:1,color:n?"$textOnColor":"$textSubdued",size:"$bodyLgMedium",$gtMd:{size:"$bodyMdMedium"},children:r}):null]}));return u?(0,a.jsx)(i.Tooltip,{renderContent:u,placement:"top",renderTrigger:f}):f}},771821:(e,t,r)=>{r.d(t,{v:()=>TokenListItem});var n=r(324586),o=r(839850),c=r(490343),i=r(791088),a=r(491180),s=r(391944),u=r(831085),d=["tokenImageSrc","networkImageSrc","tokenName","isSearch","tokenSymbol","tokenContrastAddress","balance","valueProps","disabled","titleMatchStr","moreComponent"];function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function TokenListItem(e){var t,{tokenImageSrc:r,networkImageSrc:n,tokenName:l,isSearch:f,tokenSymbol:p,tokenContrastAddress:k,balance:w,valueProps:b,disabled:m,titleMatchStr:I,moreComponent:S}=e,y=(0,o.A)(e,d);return(0,u.jsxs)(i.c,_objectSpread(_objectSpread(_objectSpread({userSelect:"none"},f&&{$md:{alignItems:"flex-start"}}),y),{},{children:[(0,u.jsx)(s.o,_objectSpread(_objectSpread({},m&&{opacity:.5}),{},{tokenImageUri:r,networkImageUri:n})),(0,u.jsx)(i.c.Text,_objectSpread(_objectSpread({},m&&{opacity:.5}),{},{flex:1,primary:p,primaryMatch:I,primaryTextProps:{numberOfLines:1},secondary:f?(0,u.jsxs)(c.Stack,{gap:"$0.5",$gtMd:{flexDirection:"row",gap:"$1"},children:[(0,u.jsx)(c.SizableText,{numberOfLines:1,color:"$textSubdued",size:"$bodyMd",children:l}),(0,u.jsx)(c.SizableText,{color:"$textDisabled",size:"$bodyMd",children:a.A.shortenAddress({address:k,leadingLength:8,trailingLength:6})})]}):null!=l?l:""})),(0,u.jsx)(i.c.Text,_objectSpread(_objectSpread({},m&&{opacity:.5}),{},{align:"right",primary:(0,u.jsx)(c.NumberSizeableText,{textAlign:"right",color:"$text",formatter:"balance",size:"$bodyLgMedium",children:w}),secondary:b?.value?(0,u.jsx)(c.NumberSizeableText,{textAlign:"right",size:"$bodyMd",formatter:"value",color:"$textSubdued",formatterOptions:{currency:null!=(t=b?.currency)?t:"$"},children:b.value}):null})),S]}))}},82506:(e,t,r)=>{r.d(t,{d:()=>useDebounce});var n=r(578104);function useDebounce(e,t,r){var[o]=(0,n.d7)(e,t,r);return o}},20322:(e,t,r)=>{r.d(t,{j:()=>useSwapFromAccountNetworkSync,z:()=>useSwapAddressInfo});var n=r(324586),o=r(586330),c=r(712784),i=r.n(c),a=r(514041),s=r(490343),u=r(153763),d=r(259227),l=r(392097),f=r(619390),p=r(317522),k=r(162616),w=r(325529);function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function useSwapFromAccountNetworkSync(){var{updateSelectedAccountNetwork:e}=(0,k.z$)().current,[t]=(0,w.NE)(),{activeAccount:r}=(0,k.LH)({num:1}),[n,c]=(0,w.rv)(),[f]=(0,w.dF)(),[,b]=(0,d.useSettingsAtom)(),[m]=(0,w.Q8)(),I=(0,a.useRef)(),S=(0,a.useRef)(),y=(0,a.useRef)(),g=(0,a.useRef)(n),j=(0,a.useRef)(r);j.current!==r&&(j.current=r),I.current!==t&&(I.current=t),S.current!==m&&(S.current=m),g.current!==n&&(g.current=n),y.current!==f&&(y.current=f);var h,v=(0,a.useCallback)(i()((0,o.A)((function*(){I.current&&(yield e({num:0,networkId:I.current?.networkId})),S.current&&(yield e({num:1,networkId:S.current?.networkId})),I.current&&S.current&&(g.current?.networkId&&S.current?.networkId!==g.current?.networkId||!g.current?.networkId&&!j.current?.account&&j.current?.wallet||!1===y.current)&&(b((function(e){return _objectSpread(_objectSpread({},e),{},{swapToAnotherAccountSwitchOn:!1})})),c((function(e){return _objectSpread(_objectSpread({},e),{},{address:void 0})})),setTimeout((function(){S.current&&e({num:1,networkId:S.current?.networkId})}),500))})),100),[b,e]),A=(0,s.usePageType)();(0,p.A)(l.V4.Swap,(h=(0,o.A)((function*(e,t){if(A!==s.EPageType.modal){if(t)return;e&&(yield v())}})),function(e,t){return h.apply(this,arguments)})),(0,a.useEffect)((function(){A!==s.EPageType.modal&&(0,o.A)((function*(){yield v()}))()}),[v,t,m,f,A]);var O=(0,u.E)();(0,a.useEffect)((function(){A===s.EPageType.modal&&O&&(0,o.A)((function*(){yield v()}))()}),[v,O,A,t,m,f])}function useSwapAddressInfo(e){var{activeAccount:t}=(0,k.LH)({num:e===f.En.FROM?0:1}),[{swapToAnotherAccountSwitchOn:r}]=(0,d.useSettingsAtom)(),[n]=(0,w.rv)();return(0,a.useMemo)((function(){var o={networkId:void 0,address:void 0,accountInfo:void 0};return e===f.En.TO&&r&&n.address&&n.networkId&&t&&t.network?.id===n.networkId?_objectSpread(_objectSpread({},o),{},{address:n.address,networkId:n.networkId,accountInfo:n.accountInfo}):t?_objectSpread(_objectSpread({},o),{},{address:t.account?.address,networkId:t.network?.id,accountInfo:_objectSpread({},t)}):o}),[e,r,n,t])}},866063:(e,t,r)=>{r.d(t,{FI:()=>useSwapInit,GM:()=>useSwapTokenList,ZF:()=>useSwapSelectedTokenInfo});var n=r(324586),o=r(503668),c=r.n(o),i=r(586330),a=r(514041),s=r(241440),u=r(490343),d=r(153763),l=r(259227),f=r(625931),p=r(22937),k=r(392097),w=r(184251),b=r(734818),m=r(58546),I=r(619390),S=r(610421),y=r(317522),g=r(162616),j=r(325529),h=r(20322);function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function useSwapInit(e){var[t,r]=(0,j.ZM)(),[n,o]=(0,j.NE)(),[s,d]=(0,j.Q8)(),[,p]=(0,l.useInAppNotificationAtom)(),{syncNetworksSort:b}=(0,j.eR)().current,v=(0,h.z)(I.En.FROM),{updateSelectedAccountNetwork:A}=(0,g.z$)().current,[O,x]=(0,a.useState)(!0),[T,N]=(0,a.useState)(!1),$=(0,a.useRef)();$.current!==v&&($.current=v);var P=(0,a.useRef)([]);P.current!==t&&(P.current=t);var _=(0,a.useRef)();_.current!==n&&(_.current=n);var E=(0,a.useRef)();E.current!==s&&(E.current=s);var M=(0,a.useCallback)((0,i.A)((function*(){if(t.length)x(!1);else{var e=yield S.A.simpleDb.swapNetworksSort.getRawData();if(e?.data?.length){var n=e?.data.every((function(e){return c()(e.supportCrossChainSwap)&&c()(e.supportSingleSwap)}));n?(e=null,S.A.simpleDb.swapNetworksSort.setRawData({data:[]})):(r(e.data),x(!1))}var o=[],i=yield S.A.serviceSwap.fetchSwapNetworks();if(o=[...i],e?.data?.length&&i?.length){var a=e.data;o=a.filter((function(e){return i.find((function(t){return t.networkId===e.networkId}))})).map((function(e){var t=i.find((function(t){return t.networkId===e.networkId}));return _objectSpread(_objectSpread({},e),t)})).concat(i.filter((function(e){return!a.find((function(t){return t.networkId===e.networkId}))})))}o.length&&(yield S.A.simpleDb.swapNetworksSort.setRawData({data:o}),e?.data?.length&&e?.data?.length===o.length||(r(o),x(!1)))}})),[r,t.length]),R=(0,a.useCallback)((0,i.A)((function*(){if(!_.current&&!E.current)if(e?.importFromToken&&P.current.find((function(t){return t.networkId===e?.importFromToken?.networkId}))||e?.importToToken&&P.current.find((function(t){return t.networkId===e?.importFromToken?.networkId}))){var t,r;if(o(e.importFromToken),d(e.importToToken),e.importFromToken&&!e.importToToken&&!e.importFromToken?.isNative){var n=m.sI[e.importFromToken.networkId];n&&d(n)}b(null!=(t=null!=(r=e.importFromToken?.networkId)?r:e.importToToken?.networkId)?t:(0,f.V)().onekeyall)}else if($.current?.accountInfo?.ready&&$.current?.networkId&&P.current.length&&(!e?.importNetworkId||!$.current?.networkId||e?.importNetworkId===$.current?.networkId)&&!T){var i=w.A.isAllNetwork({networkId:$.current?.networkId}),a=P.current.find((function(e){return e.networkId===$.current?.networkId})),s=a,u=a?.networkId;if(i){u=(0,f.V)().onekeyall;var l=m.TW[u]?.fromToken;s=P.current.find((function(e){return e.networkId===l?.networkId}))}if(s&&u&&(!c()(m.TW[u]?.fromToken)||!c()(m.TW[u]?.toToken))){var p=m.TW[u]?.fromToken,k=m.TW[u]?.toToken;p&&(o(_objectSpread(_objectSpread({},p),{},{networkLogoURI:i?p.networkLogoURI:s?.logoURI})),b(p.networkId)),k&&(d(_objectSpread(_objectSpread({},k),{},{networkLogoURI:i?k.networkLogoURI:s?.logoURI})),b(k.networkId))}}})),[e?.importFromToken,e?.importNetworkId,e?.importToToken,o,d,T,b]);(0,a.useEffect)((function(){(0,i.A)((function*(){yield S.A.serviceSwap.swapRecentTokenSync()}))()}),[p]),(0,a.useEffect)((function(){(0,i.A)((function*(){yield M()}))()}),[M,t.length]),(0,a.useEffect)((function(){(0,i.A)((function*(){e?.importNetworkId&&$.current?.networkId&&e.importNetworkId!==$.current.networkId&&(yield A({num:0,networkId:e.importNetworkId}))}))()}),[e?.importNetworkId,A]),(0,a.useEffect)((function(){(0,i.A)((function*(){yield R()}))()}),[v.accountInfo?.ready,t.length,v.networkId,e?.importFromToken,e?.importToToken,e?.importNetworkId]);var C=(0,u.usePageType)();return(0,y.A)(k.V4.Swap,(function(e,t){C!==u.EPageType.modal&&e&&N(!!t)})),{fetchLoading:O}}function useSwapTokenList(e,t,r){var[n,o]=(0,a.useState)([]),[{tokenCatch:c}]=(0,j.PQ)(),[u]=(0,j.Yb)(),[d,l]=(0,a.useState)([]),[f]=(0,j.ZM)(),{tokenListFetchAction:k,swapLoadAllNetworkTokenList:m}=(0,j.eR)().current,I=(0,h.z)(e),[y]=(0,j.Hb)();(0,a.useEffect)((function(){(0,i.A)((function*(){var e,{swapSupportAccounts:t}=yield S.A.serviceSwap.getSupportSwapAllAccounts({indexedAccountId:I?.accountInfo?.indexedAccount?.id,otherWalletTypeAccountId:I?.accountInfo?.indexedAccount?.id?void 0:null!=(e=I?.accountInfo?.account?.id)?e:I?.accountInfo?.dbAccount?.id,swapSupportNetworks:f});l(t)}))()}),[I?.accountInfo?.account?.id,I?.accountInfo?.dbAccount?.id,I?.accountInfo?.indexedAccount?.id,f]);var g=(0,a.useMemo)((function(){var e=d.find((function(e){return e.networkId===t}));return I.networkId===t?{networkId:t,keywords:r,accountAddress:I?.address,accountNetworkId:I?.networkId,accountId:I?.accountInfo?.account?.id}:{networkId:t,keywords:r,accountAddress:e?.apiAddress,accountNetworkId:e?.networkId,accountId:e?.accountId}}),[t,I.networkId,I?.address,I?.accountInfo?.account?.id,d,r]),v=(0,a.useMemo)((function(){var e,t,r;return u[null!=(e=null!=(t=null!=(r=I?.accountInfo?.indexedAccount?.id)?r:I?.accountInfo?.account?.id)?t:I?.accountInfo?.dbAccount?.id)?e:"noAccountId"]}),[u,I?.accountInfo?.indexedAccount?.id,I?.accountInfo?.account?.id,I?.accountInfo?.dbAccount?.id]),A=(0,a.useCallback)((function(e){var t=e.filter((function(e){var t,r=new s.A(null!=(t=e.price)?t:"0");return!r.isNaN()&&!r.isZero()}))?.sort((function(e,t){var r,n,o=new s.A(null!=(r=e.fiatValue)?r:"0");return new s.A(null!=(n=t.fiatValue)?n:"0").comparedTo(o)})),r=e.filter((function(e){var t,r=new s.A(null!=(t=e.price)?t:"0");return r.isNaN()||r.isZero()}))?.sort((function(e,t){var r,n,o=new s.A(null!=(r=e.fiatValue)?r:"0");return new s.A(null!=(n=t.fiatValue)?n:"0").comparedTo(o)}));return[...t,...r]}),[]),O=(0,a.useCallback)((function({swapAllNetRecommend:e,swapSearchTokens:t}){var r,n;if(e?.length&&!v)return[];var o=null!=(r=v?.map((function(e){var t=f.find((function(t){return t.networkId===e.networkId}));return t?_objectSpread(_objectSpread({},e),{},{networkLogoURI:t.logoURI}):e}))?.filter((function(e){return f.find((function(t){return t.networkId===e.networkId}))})))?r:[],c=null!=(n=o?.filter((function(e){var t,r=new s.A(null!=(t=e?.balanceParsed)?t:"0");return!r.isNaN()&&!r.isZero()})))?n:[];if(e){var i,a=null!=(i=e?.filter((function(e){return!c?.find((function(t){return(0,b.BQ)({token1:{networkId:t?.networkId,contractAddress:t?.contractAddress},token2:{networkId:e?.networkId,contractAddress:e?.contractAddress}})}))})))?i:[],u=[...c,...a];return A(null!=u?u:[])}if(t){var d=t.map((function(e){if(f.find((function(t){return t.networkId===e.networkId}))){var t=c.find((function(t){return t?.contractAddress===e?.contractAddress&&t?.networkId===e?.networkId}));return t||e}})).filter((function(e){return e}));return A(null!=d?d:[])}return[]}),[A,v,f]),x=(0,p.bJ)(w.A.isAllNetwork({networkId:g.networkId})&&r?O({swapSearchTokens:c?.[JSON.stringify(g)]?.data||[]}):c?.[JSON.stringify(g)]?.data||[],{shouldSort:!1,keys:["symbol","contractAddress"]}),T=(0,a.useRef)(x);return T.current!==x&&(T.current=x),(0,a.useEffect)((function(){var e;g.networkId&&!r&&w.A.isAllNetwork({networkId:g.networkId})&&m(I?.accountInfo?.indexedAccount?.id,I?.accountInfo?.indexedAccount?.id?void 0:null!=(e=I?.accountInfo?.account?.id)?e:I?.accountInfo?.dbAccount?.id);k(g)}),[I?.accountInfo?.account?.id,I?.accountInfo?.dbAccount?.id,I?.accountInfo?.indexedAccount?.id,m,g,k,r]),(0,a.useEffect)((function(){r&&T.current?o(T.current.search(r)):o(w.A.isAllNetwork({networkId:g.networkId})?O({swapAllNetRecommend:c?.[JSON.stringify(g)]?.data||[]}):c?.[JSON.stringify(g)]?.data||[])}),[c,g,t,r,O]),{fetchLoading:y&&0===n.length||w.A.isAllNetwork({networkId:g.networkId})&&!v,currentTokens:n}}function useSwapSelectedTokenInfo({token:e,type:t}){var r=(0,h.z)(t),[n,o]=(0,a.useState)(0),[{swapHistoryPendingList:c}]=(0,l.useInAppNotificationAtom)(),{loadSwapSelectTokenDetail:i}=(0,j.eR)().current,s=(0,a.useRef)(c);s.current!==c&&(s.current=c);var f=(0,a.useRef)(n);f.current!==n&&(f.current=n);var p=(0,a.useRef)(r);p.current!==r&&(p.current=r);var w=(0,d.E)(),b=(0,a.useRef)(w);b.current!==w&&(b.current=w),(0,a.useEffect)((function(){if(b.current&&c.length){var e=c.filter((function(e){return e.status===I.lr.SUCCESS})).length;e>f.current&&(i(t,p.current,!0),o(e))}}),[i,c,t]),(0,a.useEffect)((function(){i(t,p.current,!e?.reservationValue&&e?.isNative)}),[t,r,e?.networkId,e?.contractAddress,i,e?.reservationValue,e?.isNative]);var m=(0,u.usePageType)();(0,y.A)(k.V4.Swap,(function(e,r){if(m!==u.EPageType.modal&&e&&!r&&s.current.length){var n=s.current.filter((function(e){return e.status===I.lr.SUCCESS})).length;n>f.current&&(i(t,p.current,!0),o(n))}}))}},309008:(e,t,r)=>{r.d(t,{o:()=>d});var n=r(324586),o=r(514041),c=r(325529),i=r(2577),a=r(597102),s=r(829561),u=r(831085);function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d=(0,o.memo)((function(e){var{children:t,storeName:r}=e,n=(0,s.x6)(r),o=i.A.getOrCreateStore(n);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(a.H,_objectSpread({},n)),(0,u.jsx)(c.BY,{store:o,children:t})]})}));d.displayName="SwapProviderMirror"},89330:(e,t,r)=>{r.r(t),r.d(t,{default:()=>SwapTokenSelectModal});var n=r(324586),o=r(586330),c=r(514041),i=r(654266),a=r(241440),s=r(908867),u=r(490343),d=r(610421),l=r(325809),f=r(791088),p=r(771821),k=r(498356),w=r(82506),b=r(162616),m=r(325529),I=r(259227),S=r(334439),y=r(663522),g=r(628380),j=r(491180),h=r(117746),v=r(734818),A=r(714191),O=r(58546),x=r(619390),T=r(885127),N=r(812715),$=r(304695),P=r(831085);const _=(0,c.memo)((function({networks:e,selectedNetwork:t,onSelectNetwork:r,disableOtherNet:n,moreNetworksCount:o,onMoreNetwork:i}){var{width:a}=(0,N.A)(),d=(0,s.A)(),l=a>380,f=(0,c.useMemo)((function(){return l?e:e.slice(0,4)}),[e,l]);return(0,P.jsxs)(u.XStack,{px:"$5",pt:"$1",pb:"$3",gap:"$2",children:[f.map((function(e){return(0,P.jsx)($.V,{disabled:Boolean(n&&e.networkId!==t?.networkId),networkImageUri:e.logoURI,tooltipContent:e.isAllNetworks?d.formatMessage({id:S.ETranslations.global_all_networks}):e.name,isSelected:e?.networkId===t?.networkId,onPress:n&&e.networkId!==t?.networkId?void 0:function(){r(e)}},e.networkId)})),o&&o>0?(0,P.jsx)($.V,{disabled:n,networkName:`${o}+`,flex:1,onPress:n?void 0:i}):null]})}));var E=r(17617);const M=(0,c.memo)((function({onSelectToken:e,selectedToken:t,tokens:r}){return(0,P.jsx)(u.XStack,{pt:"$1",pb:"$3",gap:"$1.5",flexWrap:"wrap",children:r.map((function(r){return(0,P.jsxs)(u.XStack,{role:"button",userSelect:"none",alignItems:"center",px:"$1.5",py:"$1",bg:"$bg",borderRadius:"$4",borderWidth:E.A.hairlineWidth,borderColor:"$borderSubdued",hoverStyle:{bg:"$bgHover"},pressStyle:{bg:"$bgActive"},focusable:!0,focusVisibleStyle:{outlineColor:"$focusRing",outlineStyle:"solid",outlineWidth:2,outlineOffset:2},disabled:!!(0,v.BQ)({token1:t,token2:r}),onPress:function(){e(r)},disabledStyle:{opacity:.5},children:[(0,P.jsx)(u.Image,{height:"$4.5",width:"$4.5",borderRadius:"$full",children:(0,P.jsx)(u.Image.Source,{source:{uri:r.logoURI}})}),(0,P.jsx)(u.SizableText,{pl:"$1",size:"$bodyLgMedium",children:r.symbol})]},r.contractAddress)}))})}));var R=r(20322),C=r(866063),D=r(309008);function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var SwapTokenSelectPage=function(){var e=(0,k.A)(),t=(0,i.lq)(),r=(0,c.useMemo)((function(){var e;return null!=(e=t.params?.type)?e:x.En.FROM}),[t.params?.type]),n=(0,s.A)(),[l,A]=(0,c.useState)(""),N=(0,w.d)(l,500),[$]=(0,m.qv)(),[E]=(0,m.qv)(),[D]=(0,m.NE)(),[L]=(0,m.sK)(),F=(0,R.z)(x.En.FROM),z=(0,R.z)(x.En.TO),[U]=(0,m.Q8)(),[V]=(0,I.useSettingsPersistAtom)(),{selectFromToken:K,selectToToken:W,syncNetworksSort:B}=(0,m.eR)().current,{updateSelectedAccountNetwork:Z}=(0,b.z$)().current,H=(0,c.useCallback)((function(){if(r===x.En.FROM){var e,t;if(D?.networkId)return null!=(e=E.find((function(e){return e.networkId===D.networkId})))?e:E?.[0];if(U?.networkId&&L===x.qX.SWAP)return null!=(t=E.find((function(e){return e.networkId===U.networkId})))?t:E?.[0]}else{var n,o;if(U?.networkId)return null!=(n=E.find((function(e){return e.networkId===U.networkId})))?n:E?.[0];if(D?.networkId&&L===x.qX.SWAP)return null!=(o=E.find((function(e){return e.networkId===D.networkId})))?o:E?.[0]}return E?.[0]}),[D?.networkId,E,L,U?.networkId,r]),[X,q]=(0,c.useState)(H),Q=(0,c.useRef)(null);(0,c.useEffect)((function(){var e=r===x.En.FROM?F.networkId:z.networkId;X?.networkId&&X?.networkId!==e&&Z({num:r===x.En.FROM?0:1,networkId:X?.networkId})}),[]);var Y,J,{fetchLoading:G,currentTokens:ee}=(0,C.GM)(r,X?.networkId,N),te=(0,c.useMemo)((function(){return ee.findIndex((function(e){var t=e.item?e.item:e;return!t.price||new a.A(t.price).isZero()}))}),[ee]),re=(0,c.useCallback)((Y=(0,o.A)((function*(e){var t=!e.isPopular&&(!e.price||new a.A(e.price).isZero()||e.riskLevel===x.eU.SPAM||e.riskLevel===x.eU.MALICIOUS);return t?!!V.tokenRiskReminder&&!(yield d.A.serviceSetting.checkConfirmedRiskToken(`${e.networkId}_${e.contractAddress}`)):t})),function(e){return Y.apply(this,arguments)}),[V.tokenRiskReminder]),ne=(0,c.useCallback)((function(t){e.popStack(),r===x.En.FROM?K(t):W(t)}),[e,K,W,r]),oe=(0,c.useCallback)((J=(0,o.A)((function*(r){(yield re(r))?e.push(g.u.TokenRiskReminder,{storeName:t.params.storeName,token:r,onConfirm:function(){ne(r)}}):ne(r)})),function(e){return J.apply(this,arguments)}),[re,e,t.params.storeName,ne]),ce=(0,c.useCallback)((function(e){q(e),Q.current?.scrollToOffset({offset:0,animated:!1})}),[]),ie=(0,c.useCallback)((function(e){return(0,v.BQ)({token1:{networkId:r===x.En.FROM?U?.networkId:D?.networkId,contractAddress:r===x.En.FROM?U?.contractAddress:D?.contractAddress},token2:{networkId:e.networkId,contractAddress:e.contractAddress}})}),[D?.contractAddress,D?.networkId,U?.contractAddress,U?.networkId,r]),{md:ae}=(0,u.useMedia)(),{copyText:se}=(0,u.useClipboard)(),ue=(0,c.useCallback)((function({item:e,index:t}){var r,c,i,s,l=e.item?e.item:e,k=new a.A(null!=(r=l.balanceParsed)?r:0),w=new a.A(null!=(c=l.fiatValue)?c:0),b=ae?j.A.shortenAddress({address:l.contractAddress}):l.contractAddress,m={isSearch:!!N,tokenImageSrc:l.logoURI,tokenName:l.name,tokenSymbol:l.symbol,networkImageSrc:l.networkLogoURI,tokenContrastAddress:N?b:void 0,balance:k.isZero()?void 0:l.balanceParsed,valueProps:l.fiatValue&&!w.isZero()?{value:l.fiatValue,currency:V.currencyInfo.symbol}:void 0,onPress:ie(l)?void 0:function(){return oe(l)},disabled:ie(l),titleMatchStr:e.matches?.find((function(e){return"symbol"===e.key}))};return(0,P.jsxs)(P.Fragment,{children:[te===t?(0,P.jsx)(u.Stack,{pt:"$3",pb:"$2",children:(0,P.jsx)(u.Alert,{fullBleed:!0,type:"default",title:n.formatMessage({id:S.ETranslations.token_selector_unverified_token_warning}),icon:"InfoCircleOutline"})}):null,(0,P.jsx)(p.v,_objectSpread(_objectSpread({},m),{},{moreComponent:(0,P.jsx)(u.Stack,{alignSelf:"center",children:(0,P.jsx)(u.ActionList,{title:null!=(i=m.tokenSymbol)?i:"",disabled:l.isNative,renderTrigger:(0,P.jsx)(f.c.IconButton,{icon:"DotVerSolid",variant:"tertiary"}),items:[{icon:"Copy3Outline",label:n.formatMessage({id:S.ETranslations.global_copy_token_contract}),onPress:function(){se(l.contractAddress)},disabled:l.isNative},{icon:"OpenOutline",label:n.formatMessage({id:S.ETranslations.swap_token_selector_contract_info}),onPress:(s=(0,o.A)((function*(){var e=yield d.A.serviceExplorer.buildExplorerUrl({networkId:l.networkId,type:"token",param:l.contractAddress});(0,h.Dr)(e)})),function onPress(){return s.apply(this,arguments)}),disabled:l.isNative}]})})}))]})}),[te,se,n,ae,oe,ie,N,V.currencyInfo.symbol]),de=(0,c.useMemo)((function(){return r===x.En.TO&&!!D&&L===x.qX.SWAP}),[D,L,r]),le=(0,c.useMemo)((function(){var e,t=[];return E&&E.length&&(ae?(t=E.length>O.ck?E.slice(0,O.ck):E,e=E.length-O.ck>0?E.length-O.ck:void 0):(t=E.length>O.BT?E.slice(0,O.BT):E,e=E.length-O.BT>0?E.length-O.BT:void 0)),{swapNetworksCommon:t,swapNetworksMoreCount:e}}),[ae,E]),fe=(0,T.A)(),{bottom:pe}=(0,u.useSafeAreaInsets)(),ke=(0,c.useMemo)((function(){var e;return X?.networkId&&null!=(e=O.hm[X?.networkId])?e:[]}),[X?.networkId]);return(0,P.jsxs)(u.Page,{skipLoading:y.Ay.isNativeIOS,safeAreaEnabled:!1,children:[(0,P.jsx)(u.Page.Header,{title:n.formatMessage({id:S.ETranslations.token_selector_title}),headerSearchBarOptions:{placeholder:n.formatMessage({id:S.ETranslations.token_selector_search_placeholder}),onChangeText:function({nativeEvent:e}){var t=e.text.trim();A(t)}}}),(0,P.jsxs)(u.Page.Body,{children:[(0,P.jsxs)(u.XStack,{px:"$5",pb:"$2",children:[(0,P.jsx)(u.SizableText,{size:"$bodyMd",color:"$textSubdued",pr:"$2",children:`${n.formatMessage({id:S.ETranslations.token_selector_network})}`}),(0,P.jsx)(u.XStack,{children:(0,P.jsx)(u.SizableText,{size:"$bodyMd",children:X?.isAllNetworks?n.formatMessage({id:S.ETranslations.global_all_networks}):X?.name})})]}),(0,P.jsx)(_,{onMoreNetwork:function(){fe({defaultNetworkId:X?.networkId,networkIds:$.filter((function(e){return!e.isAllNetworks})).map((function(e){return e.networkId})),grouped:!1,onSelect:function(e){if(e){var t=$.find((function(t){return t.networkId===e.id}));t&&(ce(t),B(t.networkId))}}})},networks:le.swapNetworksCommon,moreNetworksCount:le.swapNetworksMoreCount,selectedNetwork:X,disableOtherNet:de,onSelectNetwork:ce}),ke.length>0&&!N?(0,P.jsx)(u.Divider,{mt:"$2"}):null,(0,P.jsx)(u.YStack,{flex:1,children:(0,P.jsx)(u.ListView,{ref:Q,data:ee,renderItem:ue,estimatedItemSize:60,ListHeaderComponent:ke.length>0&&!N?(0,P.jsxs)(u.YStack,{px:"$5",pt:"$3",gap:"$2",children:[(0,P.jsx)(u.SizableText,{size:"$bodyMd",color:"$textSubdued",pr:"$2",children:`${n.formatMessage({id:S.ETranslations.swap_token_selector_popular_token})}`}),(0,P.jsx)(M,{onSelectToken:oe,selectedToken:r===x.En.FROM?U:D,tokens:ke})]}):null,ListFooterComponent:(0,P.jsx)(u.Stack,{h:pe||"$2"}),ListEmptyComponent:G?(0,P.jsx)(P.Fragment,{children:Array.from({length:5}).map((function(e,t){return(0,P.jsxs)(f.c,{children:[(0,P.jsx)(u.Skeleton,{w:"$10",h:"$10",radius:"round"}),(0,P.jsxs)(u.YStack,{children:[(0,P.jsx)(u.YStack,{py:"$1",children:(0,P.jsx)(u.Skeleton,{h:"$4",w:"$32"})}),(0,P.jsx)(u.YStack,{py:"$1",children:(0,P.jsx)(u.Skeleton,{h:"$3",w:"$24"})})]})]},t)}))}):(0,P.jsx)(u.Empty,{icon:"SearchOutline",title:n.formatMessage({id:S.ETranslations.global_no_results}),description:n.formatMessage({id:S.ETranslations.token_no_search_results_desc})})})})]})]})},SwapTokenSelectPageWithProvider=function(){var e=(0,i.lq)(),{storeName:t}=e.params;return(0,P.jsx)(D.o,{storeName:t,children:(0,P.jsx)(SwapTokenSelectPage,{})})};function SwapTokenSelectModal(){return(0,P.jsx)(l.b8,{config:{sceneName:A.Zs.swap},enabledNum:[0,1],children:(0,P.jsx)(SwapTokenSelectPageWithProvider,{})})}}}]);